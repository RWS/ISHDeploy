<?xml version="1.0" encoding="UTF-8"?>
<BUTTONBAR>
	<BUTTON>
		<!--This button has no INPUT element so this scripts are always present -->
		<CARDTYPE>CTMAP</CARDTYPE>
		<CARDTYPE>CTMASTER</CARDTYPE>
		<CARDTYPE>CTTEMPLATE</CARDTYPE>
		<CARDTYPE>CTIMG</CARDTYPE>
		<CARDTYPE>CTCATEGORYHIERARCHY</CARDTYPE>
		<CARDTYPE>CTLIB</CARDTYPE>
		<CARDTYPE>CTPUBLICATION</CARDTYPE>
		<SCRIPT language="javascript" type="text/javascript" src="./DocumentOperation.js"/>
		<SCRIPT language="javascript" type="text/javascript" src="./scripts/document.js"/>
		<SCRIPT language="javascript" type="text/javascript" src="./scripts/infoShareAuthor.js"/>
		<SCRIPT LANGUAGE="JAVASCRIPT"><![CDATA[
			var ishTop = getIShTopWindow();
			var InfoShareXopus = ishTop.InfoShareXopus;
			//in in a popup, find the opener (e.g. Preview)
			if (!InfoShareXopus) {
				 InfoShareXopus = window.top.opener.top.InfoShareXopus;
			}		
					
			var params = InfoShareXopus.parseMandatoryParams();
		]]></SCRIPT>
	</BUTTON>
	<BUTTON>
		<!-- DOWNLOAD -->
		<CARDTYPE>CTMAP</CARDTYPE>
		<CARDTYPE>CTMASTER</CARDTYPE>
		<CARDTYPE>CTIMG</CARDTYPE>
		<CARDTYPE>CTTEMPLATE</CARDTYPE>
		<CARDTYPE>CTCATEGORYHIERARCHY</CARDTYPE>
		<CARDTYPE>CTLIB</CARDTYPE>
		<INPUT type="button" NAME="XML" onClick="getDocument()" VALUE="Download" CLASS="button" ICON="UIFramework/download.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript">
			<![CDATA[
					function getDocument()
					{
						var form = parent.DataFrame.document.DocumentInfoData;
						LngVersionId = getSelectedLngVersion();
						if (LngVersionId == "-1")
						{
							alert("Please select a language");
						}
						else
						{
							var ishTop = getIShTopWindow();
							ishTop.DocumentLoad.location = "getDocument.asp?Card=" + LngVersionId;
						}
					}
			]]>
		</SCRIPT>
	</BUTTON>
	<BUTTON>
		<CARDTYPE>CTPUBLICATION</CARDTYPE>
		<INPUT type="button" NAME="XML" onClick="getDocument()" VALUE="Download" CLASS="button" ICON="UIFramework/download.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript">
        <![CDATA[
		function getDocument()
		{
			var form = parent.DataFrame.document.DocumentInfoData;
			var LngVersionId = getSelectedLngVersion();
			var Version;
			if (LngVersionId == "-1")
			{
				alert("Please select a publication output");
			}
			else
			{
				var ishTop = getIShTopWindow();
				ishTop.DocumentLoad.location = "Api/PublicationOutput/" + LngVersionId + "/Download";
			}
		}
		]]></SCRIPT>
	 </BUTTON>
	<BUTTON CHECKACCESS="Y">
		<!-- PROPERTIES -->
		<CARDTYPE>CTMAP</CARDTYPE>
		<CARDTYPE>CTMASTER</CARDTYPE>
		<CARDTYPE>CTIMG</CARDTYPE>
		<CARDTYPE>CTTEMPLATE</CARDTYPE>
		<CARDTYPE>CTCATEGORYHIERARCHY</CARDTYPE>
		<CARDTYPE>CTLIB</CARDTYPE>
			<CARDTYPE>CTPUBLICATION</CARDTYPE>
			<INPUT type="button" NAME="Modify Language" onClick="ModifyLanguage()" VALUE="Properties" CLASS="button" ICON="UIFramework/properties.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript"><![CDATA[
		function ModifyLanguage()
		{
			var form = parent.DataFrame.document.DocumentInfoData;
			var CardType = parent.DataFrame.CardType;
			var Usergroup = parent.DataFrame.Usergroup;
			var LngVersionId = getSelectedLngVersion();
			if (LngVersionId == "-1")
			{
				alert("Please select a language");
			}
			else
			{
				DoDocumentOperation('MODIFY', CardType, form.CARD.value, LngVersionId, Usergroup, 'LNG', getVersionByLngId(LngVersionId));
			}
		}
		]]></SCRIPT>
	</BUTTON>
	<BUTTON>
		<!-- PREVIEW -->
		<CARDTYPE>CTMAP</CARDTYPE>
		<CARDTYPE>CTMASTER</CARDTYPE>
		<CARDTYPE>CTIMG</CARDTYPE>
		<CARDTYPE>CTTEMPLATE</CARDTYPE>
		<CARDTYPE>CTCATEGORYHIERARCHY</CARDTYPE>
		<CARDTYPE>CTLIB</CARDTYPE>
		<INPUT type="button" NAME="Preview" onClick="preview()" VALUE="Preview" CLASS="button" ICON="UIFramework/preview.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript">
				<![CDATA[
		function preview()
		{
			var form = parent.DataFrame.document.DocumentInfoData;
			var WindowStr = "dependent=yes,toolbar=yes,width=800,height=600,resizable=yes,scrollbars=auto,menubar=no,status=yes";
			LngVersionId = getSelectedLngVersion();
			var CardType = parent.DataFrame.CardType;
			if (LngVersionId == "-1")
			{
				alert("Please select a language");
			}
			else
			{
				var sUrl = "WorkArea/Content/ChangeTrackerPreview?languageCardId=" + LngVersionId + "&logicalId=" + parent.DataFrame.document.DocumentInfoData.CARD.value;
				if (CardType == "CTIMG" || CardType == "CTTEMPLATE") {
					linkWindow = window.open("LoadingPreview.html","",WindowStr);
					var doc = $(linkWindow.document);
					doc.ready(function() {
						setTimeout(function() {
							linkWindow.location = sUrl;
						}, 600);
					});
				} else {
					linkWindow = window.open(sUrl,"",WindowStr);
				}
				linkWindow.focus();
			}
		}
		]]></SCRIPT>
	</BUTTON>
	<BUTTON CHECKACCESS="Y">>
		<!-- START PUBLICATION -->
		<CARDTYPE>CTPUBLICATION</CARDTYPE>
		<INPUT type="button" NAME="StartPublicationButton" onClick="StartPublication()" VALUE="Publish" CLASS="button" ICON="UIFramework/publish.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript"><![CDATA[
		function StartPublication()
		{
			var form = parent.DataFrame.document.DocumentInfoData;
			var WindowStr = "dependent=yes,toolbar=yes,width=720,height=280,resizable=yes,scrollbars=auto,menubar=no,status=yes,left=50,top=30";
			var CardType = parent.DataFrame.CardType;
			var Usergroup = parent.DataFrame.Usergroup;
			var LngId = getSelectedLngVersion();
			var CardType = parent.DataFrame.CardType;
			var Version;
			if (LngId == "-1")
			{
				alert("Please select an output format of a publication");
			}
			else
			{
				if (CardType !='CTPUBLICATION')
				{
					 alert('This action is only valid for output of Publications.');
				}
				Version = getVersionByLngId(LngId);
				linkWindow = window.open("PublicationFrame.asp?Action=START&LngRef=" + LngId + "&DocumentId=" + parent.DataFrame.document.DocumentInfoData.CARD.value + "&CardType=" + CardType + "&VersionNo=" + Version,"",WindowStr);
				linkWindow.focus()
				//linkWindow.moveTo(50,30);
			}
		}
		]]></SCRIPT>
	</BUTTON>
	<BUTTON CHECKACCESS="Y">
		<!-- RELEASE PUBLICATION -->
		<CARDTYPE>CTPUBLICATION</CARDTYPE>
		<INPUT type="button" NAME="ReleasePublicationButton" onClick="ReleasePublication()" VALUE="Release" CLASS="button" ICON="UIFramework/release.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript"><![CDATA[
		function ReleasePublication()
		{
			var form = parent.DataFrame.document.DocumentInfoData;
			var WindowStr = "dependent=yes,toolbar=yes,width=720,height=280,resizable=yes,scrollbars=auto,menubar=no,status=yes,left=50,top=30";
			var CardType = parent.DataFrame.CardType;
			var Usergroup = parent.DataFrame.Usergroup;
			var LngId = getSelectedLngVersion();
			var CardType = parent.DataFrame.CardType;
			var Version;
			if (LngId == "-1")
			{
				alert("Please select an output format of a publication");
			}
			else
			{
				if (CardType !='CTPUBLICATION')
				{
					 alert('This action is only valid for output of Publications.');
				}
				Version = getVersionByLngId(LngId);
				linkWindow = window.open("PublicationFrame.asp?Action=RELEASE&LngRef=" + LngId + "&DocumentId=" + parent.DataFrame.document.DocumentInfoData.CARD.value + "&CardType=" + CardType + "&VersionNo=" + Version,"",WindowStr);
				linkWindow.focus()
				//linkWindow.moveTo(50,30);
			}
		}
		]]></SCRIPT>
	</BUTTON>
	
	
	<!-- XOPUS REMOVE "CHECKOUT & DOWNLOAD" START - The customer might want to remove this button when Xopus is used, if they only want to checkout and edit XML objects via Xopus, not by downloading the file, so comment out this button when appropriate
	 Xopus is disabled. Please obtain a license from SDL Trisoft -->
	<!--<BUTTON CHECKACCESS="Y">
		<CARDTYPE>CTMAP</CARDTYPE>
		<CARDTYPE>CTMASTER</CARDTYPE>
		<CARDTYPE>CTLIB</CARDTYPE>		
		<INPUT type="button" NAME="checkOut" onClick="checkOutXML()" VALUE="Check Out &amp; Download" CLASS="button" ICON="UIFramework/check-out.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript"><![CDATA[
		function checkOutXML()
		{
			var form        = parent.DataFrame.document.DocumentInfoData;
			var objectType  = parent.DataFrame.CardType;
			var userGroup   = parent.DataFrame.Usergroup;
			var docName     = form.CARD.value;
			var lngCardId   = getSelectedLngVersion();
			var versCardId  = getVersionIdByVersion(getVersionByLngId(lngCardId));
			var currVersion = -1;
			var AllVersions = parent.DataFrame.AllVersions;
			var ishTop 		= getIShTopWindow();
			
			if (lngCardId == "-1")
			{
				alert("Please select a language");
				return;
			}
			
			currVersion = getVersionByLngId(lngCardId) ;

			var newBranch  = nextBranchOnVersion(currVersion, AllVersions);
			var branchPart = getBranchPart(currVersion);			

			if (canAddVersion(currVersion, AllVersions))				
				ishTop.DocumentLoad.location = "./CheckOut.asp?Cmd=checkout&Card=" + lngCardId + "&Vid=" + versCardId + "&Name=" + docName + "&OType=" + objectType + "&DName=" + docName + "&UsrGrp=" + userGroup + "&Vers=" + currVersion + '&AV=1&NewBranch=' + newBranch + '&BrP=' + branchPart;
			else 
				ishTop.DocumentLoad.location = "./CheckOut.asp?Cmd=checkout&Card=" + lngCardId + "&Vid=" + versCardId + "&Name=" + docName + "&OType=" + objectType + "&DName=" + docName + "&UsrGrp=" + userGroup + "&Vers=" + currVersion + '&AV=0&NewBranch=' + newBranch + '&BrP=' + branchPart;
			
		}
		]]></SCRIPT>
	</BUTTON>-->
	<!-- Xopus is disabled. Please obtain a license from SDL Trisoft
	XOPUS REMOVE "CHECKOUT & DOWNLOAD" END -->		
	
	<BUTTON CHECKACCESS="Y">
		<!-- CHECK OUT NON XML -->
		<CARDTYPE>CTIMG</CARDTYPE>
		<CARDTYPE>CTTEMPLATE</CARDTYPE>
		<INPUT type="button" NAME="checkOutNonXML" onClick="checkOutNonXML()" VALUE="Check Out &amp; Download" CLASS="button" ICON="UIFramework/check-out.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript"><![CDATA[
		function checkOutNonXML()
		{
			var form        = parent.DataFrame.document.DocumentInfoData;
			var objectType  = parent.DataFrame.CardType;
			var userGroup   = parent.DataFrame.Usergroup;
			var docName     = form.CARD.value;
			var lngCardId   = getSelectedLngVersion();
			var versCardId  = getVersionIdByVersion(getVersionByLngId(lngCardId));
			var currVersion = -1;
			var AllVersions = parent.DataFrame.AllVersions;
			var ishTop 		= getIShTopWindow();
			
			if (lngCardId == "-1")
			{
				alert("Please select a language");
				return;
			}
			
			currVersion = getVersionByLngId(lngCardId) ;

			var newBranch  = nextBranchOnVersion(currVersion, AllVersions);
			var branchPart = getBranchPart(currVersion);			

			if (canAddVersion(currVersion, AllVersions))				
				ishTop.DocumentLoad.location = "./CheckOut.asp?Cmd=checkout&Card=" + lngCardId + "&Vid=" + versCardId + "&Name=" + docName + "&OType=" + objectType + "&DName=" + docName + "&UsrGrp=" + userGroup + "&Vers=" + currVersion + '&AV=1&NewBranch=' + newBranch + '&BrP=' + branchPart;
			else 
				ishTop.DocumentLoad.location = "./CheckOut.asp?Cmd=checkout&Card=" + lngCardId + "&Vid=" + versCardId + "&Name=" + docName + "&OType=" + objectType + "&DName=" + docName + "&UsrGrp=" + userGroup + "&Vers=" + currVersion + '&AV=0&NewBranch=' + newBranch + '&BrP=' + branchPart;
			
		}
		]]></SCRIPT>
	</BUTTON>
	
	<!-- XOPUS ADD "CHECK OUT WITH XOPUS" START -->	
	<BUTTON CHECKACCESS="Y">
		<CARDTYPE>CTMAP</CARDTYPE>
		<CARDTYPE>CTMASTER</CARDTYPE>
		<CARDTYPE>CTLIB</CARDTYPE>		
		<INPUT type="button" NAME="CheckOutWithXopus" onClick="checkOutXopus(this)" VALUE="Check Out" CLASS="button" ICON="UIFramework/check-out.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript">
				<![CDATA[				  				  				  
					
					function checkOutXopus(button) {
						var lngCardId = getSelectedLngVersion();

						if (lngCardId != -1) {
							var form        = parent.DataFrame.document.DocumentInfoData;
							var objectType  = parent.DataFrame.CardType;
							var userGroup   = parent.DataFrame.Usergroup;
							var docName     = form.CARD.value;
							var AllVersions = parent.DataFrame.AllVersions;        
							var currVersion = getVersionByLngId(lngCardId);
							var versCardId  = getVersionIdByVersion(currVersion);
							var newBranch  = nextBranchOnVersion(currVersion, AllVersions);
							var branchPart = getBranchPart(currVersion);
							var addVersionDisabled = !canAddVersion(currVersion, AllVersions);
				
							var defaultParams = $.param({ 
								 Cmd: "checkoutwithxopus", 
								 Card: lngCardId,
								 Vid: versCardId,
								 Name: docName,
								 OType: objectType,
								 DName: docName,
								 UsrGrp: userGroup,
								 Vers: currVersion,
								 AV: AllVersions,
								 NewBranch: newBranch,
								 BrP: branchPart
							});
				
							var originalButtonIcon = $(button).find("img").attr("src");        
							$(button).find("img").attr("src", "UIFramework/loader.gif");														
			 
							var addVersionAction = "/" + params.infoShareAuthorWebAppName + "/AddVersionAuto.asp?" + defaultParams + "&" + $.param({ Act: "AddVersion" });
							var addBranchAction = "/" + params.infoShareAuthorWebAppName + "/AddVersionAuto.asp?" + defaultParams + "&" + $.param({ Act: "Branch" });        
			
							InfoShareXopus.canCheckOut(lngCardId, addVersionAction, addBranchAction, addVersionDisabled, function() {
								 $(button).find("img").attr("src", originalButtonIcon);
							});

						} else {
							InfoShareXopus.showErrorDialog(0, "Please select a language.");
						}
				 }
			]]></SCRIPT>
	</BUTTON>
	<!-- XOPUS ADD "CHECK OUT WITH XOPUS" END -->	

	<!-- XOPUS REMOVE "CHECK IN" START - The customer might want to remove this button when Xopus is used, if they only want to check in XML objects from within Xopus, not by downloading and uploading, so comment out this button when appropriate
	 Xopus is disabled. Please obtain a license from SDL Trisoft -->
	<!--<BUTTON CHECKACCESS="Y">
		<CARDTYPE>CTMAP</CARDTYPE>
		<CARDTYPE>CTMASTER</CARDTYPE>
		<CARDTYPE>CTLIB</CARDTYPE>
		<INPUT type="button" NAME="checkIn" onClick="checkInXML()" VALUE="Check In" CLASS="button" ICON="UIFramework/check-in.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript"><![CDATA[
		function checkInXML()
		{
			var form = parent.DataFrame.document.DocumentInfoData;
			var CardType = parent.DataFrame.CardType;
			var Usergroup = parent.DataFrame.Usergroup;
			var LngVersionId = getSelectedLngVersion();
			if (LngVersionId == "-1")
			{
				alert("Please select a language");
			}
			else
			{
				DoDocumentOperation('CHECKIN',CardType, form.CARD.value, LngVersionId, Usergroup, 'LNG', getVersionByLngId(LngVersionId));
			}
		}
		]]></SCRIPT>
	</BUTTON>-->
	<!-- Xopus is disabled. Please obtain a license from SDL Trisoft
	 XOPUS REMOVE "CHECK IN" END -->	
	
	<BUTTON CHECKACCESS="Y">
		<!-- CHECK IN NON XML -->
		<CARDTYPE>CTIMG</CARDTYPE>
		<CARDTYPE>CTTEMPLATE</CARDTYPE>
		<INPUT type="button" NAME="checkInNonXML" onClick="checkInNonXML()" VALUE="Check In" CLASS="button" ICON="UIFramework/check-in.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript"><![CDATA[
		function checkInNonXML()
		{
			var form = parent.DataFrame.document.DocumentInfoData;
			var CardType = parent.DataFrame.CardType;
			var Usergroup = parent.DataFrame.Usergroup;
			var LngVersionId = getSelectedLngVersion();
			if (LngVersionId == "-1")
			{
				alert("Please select a language");
			}
			else
			{
				DoDocumentOperation('CHECKIN',CardType, form.CARD.value, LngVersionId, Usergroup, 'LNG', getVersionByLngId(LngVersionId));
			}
		}
		]]></SCRIPT>
	</BUTTON>

	<!-- XOPUS REMOVE "UNDO CHECK OUT" START - The customer might want to remove this button when Xopus is used, if they only want to undo check out XML objects from within Xopus, so comment out this button when appropriate -->	
	<BUTTON CHECKACCESS="Y">
		<CARDTYPE>CTMAP</CARDTYPE>
		<CARDTYPE>CTMASTER</CARDTYPE>
		<CARDTYPE>CTLIB</CARDTYPE>
		<INPUT type="button" NAME="undoCheckOut" onClick="undoCheckoutXML()" VALUE="Undo Check Out" CLASS="button" ICON="UIFramework/undo-check-out.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript"><![CDATA[
		function undoCheckoutXML()
		{
			var form = parent.DataFrame.document.DocumentInfoData;
			LngVersionId = getSelectedLngVersion();
			if (LngVersionId == "-1")
			{
				alert("Please select a language");
			}
			else
			{
				var ishTop = getIShTopWindow();
				ishTop.DocumentLoad.location = "undoCheckOut.asp?Card=" + LngVersionId;		
			}
		}
		]]></SCRIPT>
	</BUTTON>		
	<!-- XOPUS REMOVE "UNDO CHECK OUT" END -->	
	
	<BUTTON CHECKACCESS="Y">
		<!-- UNDO CHECK OUT NON XML -->
		<CARDTYPE>CTIMG</CARDTYPE>
		<CARDTYPE>CTTEMPLATE</CARDTYPE>
		<INPUT type="button" NAME="undoCheckOutNonXML" onClick="undoCheckoutNonXML()" VALUE="Undo Check Out" CLASS="button" ICON="UIFramework/undo-check-out.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript"><![CDATA[
		function undoCheckoutNonXML()
		{
			var form = parent.DataFrame.document.DocumentInfoData;
			LngVersionId = getSelectedLngVersion();
			if (LngVersionId == "-1")
			{
				alert("Please select a language");
			}
			else
			{
				var ishTop = getIShTopWindow();
				ishTop.DocumentLoad.location = "undoCheckOut.asp?Card=" + LngVersionId;		
			}
		}
		]]></SCRIPT>
	</BUTTON>

	<BUTTON CHECKACCESS="Y">
		<!-- SHOW HISTORY -->
		<CARDTYPE>CTMAP</CARDTYPE>
		<CARDTYPE>CTMASTER</CARDTYPE>
		<CARDTYPE>CTIMG</CARDTYPE>
		<CARDTYPE>CTTEMPLATE</CARDTYPE>
		<CARDTYPE>CTLIB</CARDTYPE>
		<INPUT type="button" NAME="REVISIONS" onClick="ShowRevisions()" VALUE="Show History" CLASS="button" ICON="UIFramework/history.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript">
		<![CDATA[
			function ShowRevisions()
			{
				var SelectedCard = "-1";
				var form = parent.DataFrame.document.DocumentInfoData;
				var CardType = parent.DataFrame.CardType;
				LngVersionId = getSelectedLngVersion();
				TopElement = getTopElement(LngVersionId);
				var Version = getVersionByLngId(LngVersionId ) ;
				var Language = getLanguageByLngId(LngVersionId ) ;
				var Resolution = getResolution( LngVersionId );
				var WindowStr = "dependent=yes,toolbar=yes,width=650,height=600,resizable=yes,scrollbars=auto,menubar=no,status=yes";
				if (LngVersionId == "-1")
				{
					alert("Please select a language");	
					
				}
				else
				{
					var sUrl = "ShowRevisions.asp?Card=" + LngVersionId +  "&CardType=" + parent.DataFrame.CardType + "&TopElement=" + TopElement + "&Version=" + Version + "&Language=" + Language + "&Resolution=" + Resolution;
					linkWindow = window.open(sUrl,"Revisions",WindowStr);
					linkWindow.focus()
				}
			}
			]]>
			</SCRIPT>
	</BUTTON>
	<BUTTON>
		<!-- View Report -->
		<CARDTYPE>CTPUBLICATION</CARDTYPE>
		<INPUT type="button" NAME="ShowPublicationReport" onClick="ViewPublicationReport()" VALUE="Status Report" CLASS="button" ICON="UIFramework/reports.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript"><![CDATA[
		function ViewPublicationReport()
		{
			var form = parent.DataFrame.document.DocumentInfoData;
			var WindowStr = "dependent=yes,toolbar=yes,width=720,height=520,resizable=yes,scrollbars=auto,menubar=no,status=yes,left=50,top=30";
			var CardType = parent.DataFrame.CardType;
			var Usergroup = parent.DataFrame.Usergroup;
			var LngId = getSelectedLngVersion();
			var CardType = parent.DataFrame.CardType;
				 var Version;
				 if (LngId == "-1")
			{
				alert("Please select an output format of a publication");
			}
			else
			{
						if (CardType !='CTPUBLICATION')
						{
							 alert('This action is only valid for output of Publications.');
						}
						else
						{
					 Version = getVersionByLngId(LngId);
					 linkWindow = window.open("PublicationFrame.asp?Action=STATUSREPORT&LngRef=" + LngId + "&DocumentId=" + parent.DataFrame.document.DocumentInfoData.CARD.value + "&CardType=" + CardType + "&VersionNo=" + Version,"",WindowStr);
					 linkWindow.focus()
					 //linkWindow.moveTo(50,30);
						}
			}
		}
		]]></SCRIPT>
	</BUTTON>
	<BUTTON CHECKACCESS="Y">
		<!-- CANCEL PUBLICATION -->
		<CARDTYPE>CTPUBLICATION</CARDTYPE>
		<INPUT type="button" NAME="CancelPublicationButton" onClick="CancelPublication()" VALUE="Cancel Publishing" CLASS="button" ICON="UIFramework/publish_cancel.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript"><![CDATA[
		function CancelPublication()
		{
			var form = parent.DataFrame.document.DocumentInfoData;
			var WindowStr = "dependent=yes,toolbar=yes,width=720,height=280,resizable=yes,scrollbars=auto,menubar=no,status=yes,left=50,top=30";
			var CardType = parent.DataFrame.CardType;
			var Usergroup = parent.DataFrame.Usergroup;
			var LngId = getSelectedLngVersion();
			var CardType = parent.DataFrame.CardType;
			var Version;
			if (LngId == "-1")
			{
				alert("Please select an output format of a publication");
			}
			else
			{
				if (CardType !='CTPUBLICATION')
				{
					alert('This action is only valid for output of Publications.');
				}
				else
				{
					Version = getVersionByLngId(LngId);
					 
					linkWindow = window.open("PublicationFrame.asp?Action=CANCEL&LngRef=" + LngId + "&DocumentId=" + parent.DataFrame.document.DocumentInfoData.CARD.value + "&CardType=" + CardType + "&VersionNo=" + Version,"",WindowStr);
					linkWindow.focus()
					//linkWindow.moveTo(50,30);
				}
			}
		}
		]]></SCRIPT>
	</BUTTON>
	<BUTTON CHECKACCESS="Y">
		<!-- DELETE PUBLICATION -->
		<CARDTYPE>CTPUBLICATION</CARDTYPE>
		<INPUT type="button" NAME="DeletePublicationButton" onClick="DeletePublication()" VALUE="Delete" CLASS="button" ICON="UIFramework/delete.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript"><![CDATA[
		function DeletePublication()
		{
			var form = parent.DataFrame.document.DocumentInfoData;
			var WindowStr = "dependent=yes,toolbar=yes,width=720,height=280,resizable=yes,scrollbars=auto,menubar=no,status=yes,left=50,top=30";
			var CardType = parent.DataFrame.CardType;
			var Usergroup = parent.DataFrame.Usergroup;
			var LngId = getSelectedLngVersion();
			var CardType = parent.DataFrame.CardType;
			var Version;
			if (LngId == "-1")
			{
				alert("Please select an output format of a publication");
			}
			else
			{
				if (CardType !='CTPUBLICATION')
				{
					alert('This action is only valid for output of Publications.');
				}
				else
				{
					Version = getVersionByLngId(LngId);
							 
					linkWindow = window.open("PublicationFrame.asp?Action=DELETE&LngRef=" + LngId + "&DocumentId=" + parent.DataFrame.document.DocumentInfoData.CARD.value + "&CardType=" + CardType + "&VersionNo=" + Version,"",WindowStr);
					linkWindow.focus()
					//linkWindow.moveTo(50,30);
				}
			}
		}
		]]>
		</SCRIPT>
	</BUTTON>
	<BUTTON CHECKACCESS="Y">
		<!-- DELETE -->
		<CARDTYPE>CTMAP</CARDTYPE>
		<CARDTYPE>CTMASTER</CARDTYPE>
		<CARDTYPE>CTIMG</CARDTYPE>
		<CARDTYPE>CTTEMPLATE</CARDTYPE>
		<CARDTYPE>CTLIB</CARDTYPE>
		<CARDTYPE>CTCATEGORYHIERARCHY</CARDTYPE>
		<INPUT type="button" NAME="Delete" onClick="DeleteCard()" VALUE="Delete" CLASS="button" ICON="UIFramework/delete.16x16.png"/>
		<SCRIPT language="javascript" type="text/javascript"><![CDATA[
		function DeleteCard()
		{
			var SelectedCard = "-1";
			var form = parent.DataFrame.document.DocumentInfoData;
			var CardType = parent.DataFrame.CardType;
			var Usergroup = parent.DataFrame.Usergroup;
			var Level;
			var Version;
			LngVersionId = getSelectedLngVersion();
			if (LngVersionId == "-1")
			{
				alert("Please select a language");					
			}
			else
			{
				SelectedCard = LngVersionId;
				Level = 'LNG';
				Version = getVersionByLngId(LngVersionId);
				DoDocumentOperation('DELETE', CardType, form.CARD.value, SelectedCard, Usergroup, Level,  Version);
			}			
		}
		]]></SCRIPT>
	</BUTTON>
</BUTTONBAR>

